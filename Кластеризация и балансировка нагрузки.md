# Задание 1: Round-robin балансировка на Layer 4 (TCP)
Цель: Настроить HAProxy с балансировкой Round-robin на 4 уровне (TCP) для двух backend серверов.
## 1.1. Конфигурационный файл HAProxy
Содержимое файла /etc/haproxy/haproxy.cfg для задания 1:
<img width="938" height="625" alt="image" src="https://github.com/user-attachments/assets/b77b8730-1316-4aa9-8a47-8812050c263b" />
Рисунок 1.1. Конфигурация HAProxy с режимом TCP (Layer 4) и балансировкой Round-robin
## 1.2. Статус HAProxy
Результат проверки статуса службы HAProxy:
<img width="938" height="469" alt="image" src="https://github.com/user-attachments/assets/28ebbdc0-ef43-4c0c-a5c0-e6a40e6acea1" />
Рисунок 1.2. HAProxy активен и работает корректно (Status: active/running)
Служба HAProxy успешно запущена и находится в состоянии active (running). В логах видны подключения к backend серверам на портах 8001 и 8002.
## 1.3. Демонстрация работы балансировки
Тестирование Round-robin балансировки с помощью curl:
<img width="938" height="625" alt="image" src="https://github.com/user-attachments/assets/14c10b5a-8e6a-471d-9317-8c3d506e4bc0" />
Рисунок 1.3. Запросы чередуются между Server 1 (8001) и Server 2 (8002)
Вывод: Балансировка Round-robin работает корректно. Запросы равномерно распределяются между двумя серверами в соотношении 50/50, что полностью соответствует ожидаемому поведению.
# Задание 2: Weighted Round-robin на Layer 7 (HTTP)
## 2.1. Конфигурационный файл HAProxy (часть 1)
Содержимое файла /etc/haproxy/haproxy.cfg для задания 2:
<img width="938" height="625" alt="image" src="https://github.com/user-attachments/assets/a0226f28-5119-4c9e-9065-df79c1be8c99" />
Рисунок 2.1. Конфигурация HAProxy с режимом HTTP (Layer 7), ACL для фильтрации домена
## 2.2. Конфигурационный файл HAProxy (часть 2)
Продолжение конфигурации с backend серверами и весами:
<img width="938" height="391" alt="image" src="https://github.com/user-attachments/assets/f98658ee-33e1-4806-889c-c526c7809b49" />
Рисунок 2.2. Backend с Weighted Round Robin (веса: 2, 3, 4)
## 2.3. Настройка /etc/hosts
Для работы с доменом example.local добавлена запись в /etc/hosts:
 <img width="625" height="125" alt="image" src="https://github.com/user-attachments/assets/046f2d56-3e08-4f80-95d8-31cae7f7ad05" />
Рисунок 2.3. Домен example.local указывает на localhost (127.0.0.1)
## 2.4. Тест балансировки С доменом example.local
Тестирование Weighted Round-robin с использованием заголовка Host: example.local:
<img width="938" height="703" alt="image" src="https://github.com/user-attachments/assets/29273a03-9dd1-4ece-a899-6bfa160ab6fe" />
Рисунок 2.4. Результаты 18 запросов с доменом example.local
## 2.5. Тест запроса БЕЗ домена example.local
Проверка отклонения запросов без нужного домена:
<img width="938" height="469" alt="image" src="https://github.com/user-attachments/assets/3b7ceba4-ec50-4cb0-9182-424766d93329" />
Рисунок 2.5. Запрос без заголовка Host: example.local отклонён (503 Service Unavailable)
## 2.6. Тест запроса с ДРУГИМ доменом
Проверка отклонения запросов с неправильным доменом (other.local):
<img width="781" height="188" alt="image" src="https://github.com/user-attachments/assets/8f6059d7-583e-4ee9-a80c-12311d31f2ed" />
Рисунок 2.6. Запрос с доменом other.local отклонён (503 Service Unavailable)
## 2.7. Статус HAProxy
Результат проверки статуса службы HAProxy для задания 2:
<img width="938" height="469" alt="image" src="https://github.com/user-attachments/assets/c2101d7d-67ec-4adf-9da7-b3892d4fc7e9" />
Рисунок 2.7. HAProxy активен, в логах видна работа балансировки на все три сервера
